random_fkbgs_question = () => { let target_question = []; let target_word = []; for (let i = 0; i < 4; ++i) { target_question[i] = random(0, fkbgs.length); target_word[i] = random(0, fkbgs[target_question[i]]["content"].length); while (fkbgs[target_question[i]]["content"][target_word[i]] == "，" || fkbgs[target_question[i]]["content"][target_word[i]] == "。" || fkbgs[target_question[i]]["content"][target_word[i]] == "？" || fkbgs[target_question[i]]["content"][target_word[i]] == "！" || fkbgs[target_question[i]]["content"][target_word[i]] == "\n" || (i >= 1 && fkbgs[target_question[i]]["content"][target_word[i]] == fkbgs[target_question[i]]["content"][target_word[i - 1]]) || (i >= 2 && fkbgs[target_question[i]]["content"][target_word[i]] == fkbgs[target_question[i]]["content"][target_word[i - 2]]) || (i >= 3 && fkbgs[target_question[i]]["content"][target_word[i]] == fkbgs[target_question[i]]["content"][target_word[i - 3]])) target_word[i] = random(0, fkbgs[target_question[i]]["content"].length); } let answer_sort = [[0, Math.random()], [1, Math.random()], [2, Math.random()], [3, Math.random()]]; answer_sort.sort((a, b) => a[1] - b[1]); return "请选择合适的字填入空中:\n" + "《" + (fkbgs[target_question[0]]["tune"] ? (fkbgs[target_question[0]]["tune"] + "·") : "") + fkbgs[target_question[0]]["name"] + "》" + "\n" + "【作者】" + (fkbgs[target_question[0]]["period"] ? ("(" + fkbgs[target_question[0]]["period"]) + ")" : "") + fkbgs[target_question[0]]["author"] + "\n" + fkbgs[target_question[0]]["content"].substr(0, target_word[0]) + "__" + fkbgs[target_question[0]]["content"].substr(target_word[0] + 1) + "\n" + "A. " + fkbgs[target_question[answer_sort[0][0]]]["content"][target_word[answer_sort[0][0]]] + "\n" + "B. " + fkbgs[target_question[answer_sort[1][0]]]["content"][target_word[answer_sort[1][0]]] + "\n" + "C. " + fkbgs[target_question[answer_sort[2][0]]]["content"][target_word[answer_sort[2][0]]] + "\n" + "D. " + fkbgs[target_question[answer_sort[3][0]]]["content"][target_word[answer_sort[3][0]]]; }